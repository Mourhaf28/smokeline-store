<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø§Øµ</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap" rel="stylesheet">
  <style>
  body {
    background: #0f0f0f;
    color: #fff;
    font-family: 'Cairo', sans-serif;
    padding: 25px;
    font-size: 21px;
    line-height: 1.7;
  }

  h2, h3 {
    font-size: 28px;
    color: #e5c9a0;
    text-align: center;
    margin-bottom: 20px;
  }

  .box {
    background: #1c1c1c;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 30px;
    border: 1px solid #333;
    box-shadow: 0 0 10px rgba(229, 201, 160, 0.2);
    font-size: 20px;
  }

  label {
    display: block;
    margin-top: 18px;
    font-weight: bold;
    font-size: 20px;
  }

  input, select, textarea, button {
    padding: 14px;
    margin-top: 8px;
    width: 100%;
    border: none;
    border-radius: 8px;
    background-color: #e5c9a0;
    color: #000;
    font-size: 20px;
    transition: box-shadow 0.3s;
  }

  input:focus, select:focus, textarea:focus {
    box-shadow: 0 0 5px #d4af37;
    outline: none;
  }

  button {
    cursor: pointer;
    margin-top: 22px;
    background-color: #d4af37;
    color: #000;
    font-weight: bold;
    font-size: 20px;
  }

  button:hover {
    background-color: #f0d88a;
  }

  #region-group {
    display: none;
  }

  #save-status, #points-result, #redeem-result {
    margin-top: 22px;
    color: #e5c9a0;
    font-weight: bold;
    text-align: center;
    font-size: 20px;
  }

  hr {
    border: none;
    border-top: 1px solid #444;
    margin: 45px 0 25px;
  }
</style>

</head>
<body>

  <h2>ğŸ›ï¸ Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø§Øµ</h2>

  <div class="box">
    <p><strong>Ø§Ù„Ù…Ù†ØªØ¬:</strong> <span id="product-name"></span></p>
    <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="product-price"></span></p>
    <p><strong>Ø§Ù„ÙƒÙ…ÙŠØ©:</strong> <span id="product-quantity"></span></p>
    <p><strong>Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆÙ„Ø§Ø¡:</strong> <span id="product-points"></span></p>
  </div>

  <form onsubmit="submitOrder(event)">
    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
    <input type="text" id="customer-name" required>

    <label>Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø¥Ù…Ø§Ø±Ø§ØªÙŠ:</label>
    <input type="tel" id="customer-phone" placeholder="05..." maxlength="10" autocomplete="off" required>

    <label>Ø§Ù„Ø¥Ù…Ø§Ø±Ø©:</label>
    <select id="emirate" onchange="showRegion()" required>
      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ù…Ø§Ø±Ø©</option>
      <option value="Ø¯Ø¨ÙŠ">Ø¯Ø¨ÙŠ</option>
      <option value="Ø£Ø¨ÙˆØ¸Ø¨ÙŠ">Ø£Ø¨ÙˆØ¸Ø¨ÙŠ</option>
      <option value="Ø§Ù„Ø´Ø§Ø±Ù‚Ø©">Ø§Ù„Ø´Ø§Ø±Ù‚Ø©</option>
      <option value="Ø¹Ø¬Ù…Ø§Ù†">Ø¹Ø¬Ù…Ø§Ù†</option>
      <option value="Ø±Ø£Ø³ Ø§Ù„Ø®ÙŠÙ…Ø©">Ø±Ø£Ø³ Ø§Ù„Ø®ÙŠÙ…Ø©</option>
      <option value="Ø£Ù… Ø§Ù„Ù‚ÙŠÙˆÙŠÙ†">Ø£Ù… Ø§Ù„Ù‚ÙŠÙˆÙŠÙ†</option>
      <option value="Ø§Ù„ÙØ¬ÙŠØ±Ø©">Ø§Ù„ÙØ¬ÙŠØ±Ø©</option>
    </select>

    <div id="region-group">
      <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</label>
      <input type="text" id="region" required>
    </div>

    <button type="submit">ğŸ“¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
  </form>

  <p id="save-status"></p>

  <hr>
  <h3>ğŸ“Š Ø¹Ø±Ø¶ Ø±ØµÙŠØ¯ÙŠ</h3>
  <input type="tel" id="check-phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…Ùƒ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠ" maxlength="10" autocomplete="off">
  <button onclick="checkPoints()">Ø¹Ø±Ø¶ Ø§Ù„Ø±ØµÙŠØ¯</button>
  <p id="points-result"></p>
<script>
  const params = new URLSearchParams(window.location.search);
  const name = params.get("name") || "";
  const price = params.get("price") || "";
  const quantity = params.get("quantity") || "";
  const points = params.get("points") || "0";

  document.getElementById("product-name").textContent = name;
  document.getElementById("product-price").textContent = price + " Ø¯Ø±Ù‡Ù…";
  document.getElementById("product-quantity").textContent = quantity + " ÙƒØ±ÙˆØ²";
  document.getElementById("product-points").textContent = points + " Ù†Ù‚Ø·Ø©";

  function showRegion() {
    const emirate = document.getElementById("emirate").value;
    document.getElementById("region-group").style.display = emirate ? "block" : "none";
  }

  function submitOrder(e) {
    e.preventDefault();

    const customerName = document.getElementById("customer-name").value.trim();
    const phone = document.getElementById("customer-phone").value.trim();
    const formattedPhone = phone;
    const emirate = document.getElementById("emirate").value;
    const region = document.getElementById("region").value.trim();

    if (!phone.startsWith("05")) {
      alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 05");
      return;
    }

    document.getElementById("save-status").textContent = "ğŸ“¡ Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ù†Ù‚Ø§Ø·...";

    let message = `ğŸ›ï¸ Ø·Ù„Ø¨ Ø¹Ø±Ø¶ Ø®Ø§Øµ\n`;
    message += `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${customerName}\n`;
    message += `ğŸ“± Ø§Ù„Ø±Ù‚Ù…: ${phone}\n`;
    message += `ğŸ™ï¸ Ø§Ù„Ø¥Ù…Ø§Ø±Ø©: ${emirate}\n`;
    message += `ğŸ“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${region}\n`;
    message += `\nğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${name}\n`;
    message += `ğŸ“¦ Ø§Ù„ÙƒÙ…ÙŠØ©: ${quantity} ÙƒØ±ÙˆØ²\n`;
    message += `ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¯Ø±Ù‡Ù…\n`;
    message += `ğŸ¯ Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆÙ„Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©: ${points}\n`;

    const encoded = encodeURIComponent(message);
    const myNumber = "963960048355";
    window.open(`https://wa.me/${myNumber}?text=${encoded}`, "_blank");

    const query = new URLSearchParams({
      name: customerName,
      phone: formattedPhone,
      points: points,
      source: `Ø¹Ø±Ø¶ Ø®Ø§Øµ: ${name}`
    }).toString();

    fetch(`https://script.google.com/macros/s/AKfycbx8C3m8sAwYw-_jP-jJgGS-xmYVIHvEjlFqPPnSyDLXt-GRxnM2_ZGVDmbDYMb2aqkx/exec?${query}`)
      .then(res => res.text())
      .then(txt => {
        document.getElementById("save-status").textContent = "ğŸ“Œ Ø±Ø¯ Ø§Ù„Ø³ÙƒØ±Ø¨Øª: " + txt;
      })
      .catch(err => {
        document.getElementById("save-status").textContent = "âŒ Ø®Ø·Ø£ Ø¨Ø§Ù„Ø­ÙØ¸: " + err.message;
      });
  }

  function checkPoints() {
    const phone = document.getElementById("check-phone").value.trim();

    if (!phone.startsWith("05")) {
      alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 05");
      return;
    }

    const query = new URLSearchParams({
      phone: phone,
      check: "true"
    }).toString();

    fetch(`https://script.google.com/macros/s/AKfycbx8C3m8sAwYw-_jP-jJgGS-xmYVIHvEjlFqPPnSyDLXt-GRxnM2_ZGVDmbDYMb2aqkx/exec?${query}`)
      .then(res => res.text())
      .then(txt => {
        document.getElementById("points-result").textContent = txt;
      })
      .catch(err => {
        document.getElementById("points-result").textContent = "âŒ Ø®Ø·Ø£: " + err.message;
      });
  }
</script>

</body>
</html>
