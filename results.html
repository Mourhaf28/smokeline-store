<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ”Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ğŸ”</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background-color: #0b0b0b;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }
    h1 {
      color: #e5c9a0;
      text-align: center;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #1a1a1a;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #333;
      text-align: right;
    }
    th {
      background-color: #2c2c2c;
      color: #e5c9a0;
    }
    tr:hover {
      background-color: #222;
    }
    .no-results {
      text-align: center;
      margin-top: 40px;
      font-size: 16px;
      color: #aaa;
    }
  </style>
</head>
<body>

<h1>ğŸ”Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ğŸ”</h1>
  <div style="text-align:center; margin-bottom:30px;">
  <button onclick="goHome()" style="padding:10px 20px; font-size:16px; border-radius:6px; background-color:#e5c9a0; color:#000; border:none; cursor:pointer;">
    â¬…ï¸ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  </button>
</div>
<table id="results-table">
  <thead>
    <tr>
      <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
      <th>Ø§Ù„Ø³Ø¹Ø± (AED)</th>
      <th>Ø§Ù„Ø¹Ø±Ø¶</th>
      <th>Ø§Ù„Ù‚Ø³Ù…</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="no-results" id="no-results" style="display:none;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©.</div>

<script>
  const query = localStorage.getItem("searchQuery")?.toLowerCase().trim() ?? "";
  const dataURL = "https://script.google.com/macros/s/AKfycbwFvP8QP9vdwpyL_Toy6CSwyefmy_A3Fx05CKoyZI4ANN5db6BySGBKMaQxsiGafYnQ7Q/exec";

  fetch(dataURL)
    .then(res => res.json())
    .then(data => {
      const allProducts = data.filter(item => {
        const offer = item.offer?.trim();
        return ["offer1", "offer2", "offer3", "offer4", "offer5", "offer6"].includes(offer);
      }).map(item => ({
        name: item.name?.trim() ?? "Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",
        price: parseFloat(item.price) || 0,
        offer: item.offer?.trim(),
        section: item.title?.trim() ?? "Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ"
      }));

      const isNumeric = !isNaN(query);
      const qNum = parseFloat(query);

      const results = allProducts.filter(item => {
        const nameMatch = item.name.toLowerCase().includes(query);
        const priceMatch = isNumeric && Math.abs(item.price - qNum) <= 20;
        return nameMatch || priceMatch;
      });

      const tableBody = document.querySelector("#results-table tbody");
      const noResults = document.getElementById("no-results");

      if (results.length === 0) {
        noResults.style.display = "block";
        return;
      }

      results.forEach(item => {
        const row = document.createElement("tr");
row.style.cursor = "pointer";
row.addEventListener("click", () => {
  localStorage.setItem("selectedProduct", item.name);
  window.location.href = "order.html";
});
row.innerHTML = `
  <td>${item.name}</td>
  <td>${item.price}</td>
  <td>${item.offer}</td>
  <td>${item.section}</td>
`;
tableBody.appendChild(row);
      });
    });
</script>
<script>
  function goHome() {
    window.location.href = "index.html"; // ØºÙŠÙ‘Ø± Ø§Ù„Ø§Ø³Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØµÙØ­ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¨Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù
  }
</script>
</body>
</html>
